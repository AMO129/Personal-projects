<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Moses Abraham | Portfolio</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary: #0078ff;
      --bg: #f4f4f9;
      --card-bg: #ffffff;
      --text: #333;
      --header-bg: #111;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      line-height: 1.6;
    }

    header {
      background: var(--header-bg);
      color: white;
      text-align: center;
      padding: 4rem 1rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    header h1 { margin: 0; letter-spacing: 2px; font-size: 2.5rem; }
    header p { opacity: 0.8; font-weight: 300; }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .section-title {
      border-left: 5px solid var(--primary);
      padding-left: 15px;
      margin: 3rem 0 1.5rem 0;
      font-size: 1.8rem;
    }

    .grid {
      display: grid;
      gap: 2rem;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    }

    .card {
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: all 0.3s ease;
      border: 1px solid rgba(0,0,0,0.05);
    }

    .card:hover {
      transform: translateY(-10px);
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
      border-color: var(--primary);
    }

    .card h3 { margin: 0 0 12px 0; color: #111; }
    .card p { color: #555; margin-bottom: 20px; flex-grow: 1; }

    .btn-link {
      background: var(--primary);
      color: white;
      text-decoration: none;
      font-weight: 600;
      padding: 10px 20px;
      border-radius: 8px;
      text-align: center;
      transition: 0.3s;
    }

    .btn-link:hover {
      background: #0056b3;
      filter: brightness(1.1);
    }

    .status-msg {
      text-align: center;
      padding: 2rem;
      font-style: italic;
      color: #777;
    }

    footer {
      text-align: center;
      padding: 4rem 1rem;
      background: var(--header-bg);
      color: #888;
      margin-top: 5rem;
    }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      header h1 { font-size: 1.8rem; }
    }
  </style>
</head>
<body>

  <header>
    <h1>MOSES OWALAMA ABRAHAM</h1>
    <p>Software Developer | AI Enthusiast</p>
  </header>

  <div class="container">
    <section id="projects-section">
      <h2 class="section-title">Latest Projects</h2>
      <div id="project-list" class="grid">
        <p class="status-msg">Fetching projects from the fleet command...</p>
      </div>
    </section>

    <section id="blogs-section">
      <h2 class="section-title">Articles & Blogs</h2>
      <div id="blog-list" class="grid">
        <p class="status-msg">Loading latest thoughts...</p>
      </div>
    </section>
  </div>

  <footer>
    <p>© <span id="year"></span> Moses Abraham. Verified Developer.</p>
  </footer>

  <script>
    // 1. YOUR CONFIGURATION
    const SHEET_ID = "17Y6wejfh9AILhsNXVbYwtmLCx_MfCZvuODV-lievVps";
    const API_KEY = "AIzaSyDW1Yk4SimAEtSB98yCq8sO7FiMKJlt1y8";
    const RANGE = "'Portfolio Data'!A2:D"; // CHANGE THIS to "Sheet1!A2:D" if needed!

    async function loadPortfolio() {
      const projectList = document.getElementById('project-list');
      const blogList = document.getElementById('blog-list');

      try {
        const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`);
        const data = await response.json();
        
        // Debugging: This helps find errors in the browser console (F12)
        if (data.error) {
          console.error("Google API Error:", data.error.message);
          projectList.innerHTML = `<p style="color:red">Error: ${data.error.message}. Ensure the Sheet is Public!</p>`;
          return;
        }

        if (!data.values || data.values.length === 0) {
          projectList.innerHTML = "<p class='status-msg'>No projects found in the sheet yet.</p>";
          blogList.innerHTML = "<p class='status-msg'>No blog posts found yet.</p>";
          return;
        }

        // Clear loading messages
        projectList.innerHTML = "";
        blogList.innerHTML = "";

        // Loop through rows and create cards
        data.values.forEach(([type, title, desc, link]) => {
          if (!title) return; // Skip empty rows

          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <div>
              <h3>${title}</h3>
              <p>${desc || 'No description provided.'}</p>
            </div>
            ${link ? `<a href="${link}" target="_blank" class="btn-link">Explore →</a>` : ''}
          `;

          if (type && type.toLowerCase().includes('project')) {
            projectList.appendChild(card);
          } else if (type && type.toLowerCase().includes('blog')) {
            blogList.appendChild(card);
          }
        });

      } catch (err) {
        console.error("Connection Error:", err);
        projectList.innerHTML = "<p style='color:red'>Failed to connect to the database. Check your internet.</p>";
      }
    }

    // Set current year in footer
    document.getElementById("year").textContent = new Date().getFullYear();

    // Start the fetch
    loadPortfolio();
  </script>
</body>
</html>